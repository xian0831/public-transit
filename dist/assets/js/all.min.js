"use strict";!function(){angular.module("transit-app",["ui.router"]),angular.module("transit-app").constant("WMATA_API_KEY","b8d72d4443d84c0a9acc8c6e4481a3b9")}(),function(){function t(t,e,o){o.validRoute=!0,o.getSchedule=function(){var e=new Date,n=e.getHours()+":"+e.getMinutes()+":"+e.getSeconds();o.schedules=i(o.originationId,o.destinationId).filter(function(t){return t.origTime>=n&&t.origTime<"24:00:00"}),t.log(o.schedules)},e.stops().then(function(t){return Papa.parse(t.data,{delimiter:",",header:!0}).data}).then(function(t){o.stops=t}),e.stopTimes().then(function(t){return Papa.parse(t.data,{delimiter:",",header:!0}).data}).then(function(e){o.stopTimes=e,t.log(o.stopTimes)});var i=function(t,e){for(var i,r,a,s=[],c=0,u=o.stopTimes.length;u>c;c++)t===o.stopTimes[c].stop_id?(i=o.stopTimes[c].trip_id,r=o.stopTimes[c].stop_sequence,a=o.stopTimes[c].arrival_time):e===o.stopTimes[c].stop_id&&i===o.stopTimes[c].trip_id&&r<o.stopTimes[c].stop_sequence&&s.push({tripId:i,origTime:a,distTime:o.stopTimes[c].arrival_time,duration:n(a,o.stopTimes[c].arrival_time)});return 0===s.length?(o.validRoute=!1,console.log("The destination is not reachable from the origination.")):o.validRoute=!0,s},n=function(t,e){var o=t.split(":"),i=e.split(":");return 60*+i[0]+ +i[1]-(60*+o[0]+ +o[1])}}angular.module("transit-app").controller("HomeController",t),t.$inject=["$log","localResourceService","$scope"]}(),function(){function t(t){function e(){return t.get("data/agency.json")}function o(){return t.get("data/rail_stops.txt")}function i(){return t.get("data/rail_stop_time.txt")}var n;return n={agency:e,stops:o,stopTimes:i}}angular.module("transit-app").factory("localResourceService",t),t.$inject=["$http"]}(),function(){function t(t,e){function o(){return e({method:"GET",url:"https://api.wmata.com/Rail.svc/json/jStations?LineCode=RD",headers:{api_key:"b8d72d4443d84c0a9acc8c6e4481a3b9"}})}var i;return i={stops:o}}angular.module("transit-app").factory("trainResourceService",t),t.$inject=["WMATA_API_KEY","$http"]}(),function(){function t(t,e){e.otherwise("/home"),t.state("home",{url:"/home",templateUrl:"app/partials/home/home.html",controller:"HomeController"}).state("about",{})}angular.module("transit-app").config(t),t.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js",{scope:"/"}).then(function(t){console.log("Registration succeeded. Scope is "+t.scope)})["catch"](function(t){console.log("Registration failed with "+t)})}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFsbC5taW4uanMiLCJhcHAubW9kdWxlLmpzIiwiaG9tZS9ob21lLmNvbnRyb2xsZXIuanMiLCJzZXJ2aWNlcy9sb2NhbHJlc291cmNlLnNlcnZpY2UuanMiLCJzZXJ2aWNlcy90cmFpbnJlc291cmNlLnNlcnZpY2UuanMiLCJhcHAucm91dGVzLmpzIiwianMvcmVnaXN0ZXJTVy5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uc3RhbnQiLCJIb21lQ29udHJvbGxlciIsIiRsb2ciLCJsb2NhbFJlc291cmNlU2VydmljZSIsIiRzY29wZSIsInZhbGlkUm91dGUiLCJnZXRTY2hlZHVsZSIsImRhdGUiLCJEYXRlIiwiY3VycmVudFRpbWUiLCJnZXRIb3VycyIsImdldE1pbnV0ZXMiLCJnZXRTZWNvbmRzIiwic2NoZWR1bGVzIiwiZmluZFZhbGlkVHJpcCIsIm9yaWdpbmF0aW9uSWQiLCJkZXN0aW5hdGlvbklkIiwiZmlsdGVyIiwidHJpcCIsIm9yaWdUaW1lIiwibG9nIiwic3RvcHMiLCJ0aGVuIiwicmVzcG9uc2UiLCJQYXBhIiwicGFyc2UiLCJkYXRhIiwiZGVsaW1pdGVyIiwiaGVhZGVyIiwic3RvcFRpbWVzIiwib3JpZ0lkIiwiZGlzdElkIiwidHJpcElkIiwib3JpZ1NlcSIsInZhbGlkVHJpcHMiLCJpIiwibGVuZ3RoIiwic3RvcF9pZCIsInRyaXBfaWQiLCJzdG9wX3NlcXVlbmNlIiwiYXJyaXZhbF90aW1lIiwicHVzaCIsImRpc3RUaW1lIiwiZHVyYXRpb24iLCJnZXRUaW1lRGlmZiIsImNvbnNvbGUiLCJzdGFydFRpbWUiLCJlbmRUaW1lIiwic3RhcnRUaW1lc3RhbXAiLCJzcGxpdCIsImVuZFRpbWVzdGFtcCIsImNvbnRyb2xsZXIiLCIkaW5qZWN0IiwiJGh0dHAiLCJhZ2VuY3kiLCJnZXQiLCJyZXNvdXJjZSIsImZhY3RvcnkiLCJ0cmFpblJlc291cmNlU2VydmljZSIsIldNQVRBX0FQSV9LRVkiLCJtZXRob2QiLCJ1cmwiLCJoZWFkZXJzIiwiYXBpX2tleSIsImNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwib3RoZXJ3aXNlIiwic3RhdGUiLCJ0ZW1wbGF0ZVVybCIsIm5hdmlnYXRvciIsInNlcnZpY2VXb3JrZXIiLCJyZWdpc3RlciIsInNjb3BlIiwicmVnIiwiZXJyb3IiXSwibWFwcGluZ3MiOiJBQUFBLGNDQUEsV0FHSUEsUUFDS0MsT0FBTyxlQUFnQixjQUU1QkQsUUFDS0MsT0FBTyxlQUNQQyxTQUFTLGdCQUFnQix1Q0NMbEMsV0FTSSxRQUFTQyxHQUFlQyxFQUFNQyxFQUFzQkMsR0FFaERBLEVBQU9DLFlBQWEsRUFFcEJELEVBQU9FLFlBQWMsV0FDakIsR0FBSUMsR0FBTyxHQUFJQyxNQUNYQyxFQUFjRixFQUFLRyxXQUFXLElBQUlILEVBQUtJLGFBQWEsSUFBSUosRUFBS0ssWUFDakVSLEdBQU9TLFVBQVlDLEVBQWNWLEVBQU9XLGNBQWVYLEVBQU9ZLGVBQWVDLE9BQU8sU0FBU0MsR0FDekYsTUFBUUEsR0FBS0MsVUFBWVYsR0FBZVMsRUFBS0MsU0FBVyxhQUU1RGpCLEVBQUtrQixJQUFJaEIsRUFBT1MsWUFNcEJWLEVBQXFCa0IsUUFBUUMsS0FBSyxTQUFTQyxHQUN2QyxNQUFPQyxNQUFLQyxNQUFNRixFQUFTRyxNQUN2QkMsVUFBVyxJQUNYQyxRQUFRLElBQ1RGLE9BRUpKLEtBQUssU0FBU0ksR0FDYnRCLEVBQU9pQixNQUFRSyxJQUduQnZCLEVBQXFCMEIsWUFBWVAsS0FBSyxTQUFTQyxHQUMzQyxNQUFPQyxNQUFLQyxNQUFNRixFQUFTRyxNQUN2QkMsVUFBVyxJQUNYQyxRQUFRLElBQ1RGLE9BRUpKLEtBQUssU0FBU0ksR0FDYnRCLEVBQU95QixVQUFZSCxFQUNuQnhCLEVBQUtrQixJQUFJaEIsRUFBT3lCLFlBR3BCLElBQUlmLEdBQWdCLFNBQVVnQixFQUFRQyxHQU1sQyxJQUFJLEdBSkFDLEdBQ0FDLEVBQ0FkLEVBSEFlLEtBS0lDLEVBQUksRUFBR0MsRUFBU2hDLEVBQU95QixVQUFVTyxPQUFZQSxFQUFKRCxFQUFZQSxJQUN0REwsSUFBVzFCLEVBQU95QixVQUFVTSxHQUFHRSxTQUM5QkwsRUFBUzVCLEVBQU95QixVQUFVTSxHQUFHRyxRQUM3QkwsRUFBVTdCLEVBQU95QixVQUFVTSxHQUFHSSxjQUM5QnBCLEVBQVdmLEVBQU95QixVQUFVTSxHQUFHSyxjQUN4QlQsSUFBVzNCLEVBQU95QixVQUFVTSxHQUFHRSxTQUNsQ0wsSUFBVzVCLEVBQU95QixVQUFVTSxHQUFHRyxTQUFXTCxFQUFVN0IsRUFBT3lCLFVBQVVNLEdBQUdJLGVBQ3hFTCxFQUFXTyxNQUNQVCxPQUFTQSxFQUNUYixTQUFVQSxFQUNWdUIsU0FBVXRDLEVBQU95QixVQUFVTSxHQUFHSyxhQUM5QkcsU0FBVUMsRUFBWXpCLEVBQVNmLEVBQU95QixVQUFVTSxHQUFHSyxlQWNuRSxPQU55QixLQUF0Qk4sRUFBV0UsUUFDVmhDLEVBQU9DLFlBQWEsRUFDcEJ3QyxRQUFRekIsSUFBSSwyREFFWmhCLEVBQU9DLFlBQWEsRUFFakI2QixHQUlQVSxFQUFjLFNBQVVFLEVBQVdDLEdBQ25DLEdBQUlDLEdBQWlCRixFQUFVRyxNQUFNLEtBQ2pDQyxFQUFlSCxFQUFRRSxNQUFNLElBRWpDLE9BQTJCLEtBQWpCQyxFQUFhLEtBQVdBLEVBQWEsSUFBNkIsSUFBbkJGLEVBQWUsS0FBV0EsRUFBZSxLQWxGMUdsRCxRQUNLQyxPQUFPLGVBQ1BvRCxXQUFXLGlCQUFpQmxELEdBRWpDQSxFQUFlbUQsU0FBVyxPQUFPLHVCQUF1QixhQ1A1RCxXQVNJLFFBQVNqRCxHQUFxQmtELEdBUTFCLFFBQVNDLEtBQ0wsTUFBT0QsR0FBTUUsSUFBSSxvQkFHckIsUUFBU2xDLEtBQ0wsTUFBT2dDLEdBQU1FLElBQUksdUJBR3JCLFFBQVMxQixLQUNMLE1BQU93QixHQUFNRSxJQUFJLDJCQWhCckIsR0FBSUMsRUFtQkosT0FsQkFBLElBQ0lGLE9BQVFBLEVBQ1JqQyxNQUFPQSxFQUNQUSxVQUFXQSxHQVhuQi9CLFFBQ0tDLE9BQU8sZUFDUDBELFFBQVEsdUJBQXVCdEQsR0FFcENBLEVBQXFCaUQsU0FBVyxZQ1BwQyxXQVNJLFFBQVNNLEdBQXFCQyxFQUFjTixHQU94QyxRQUFTaEMsS0FDTCxNQUFRZ0MsSUFDSk8sT0FBUSxNQUNSQyxJQUFLLDREQUNMQyxTQUFVQyxRQUFXLHNDQVY3QixHQUFJUCxFQWdCSixPQWRBQSxJQUNJbkMsTUFBUUEsR0FWaEJ2QixRQUNLQyxPQUFPLGVBQ1AwRCxRQUFRLHVCQUF1QkMsR0FFcENBLEVBQXFCTixTQUFXLGdCQUFnQixZQ1ZwRCxXQVNJLFFBQVNZLEdBQU9DLEVBQWdCQyxHQUM1QkEsRUFBbUJDLFVBQVUsU0FFN0JGLEVBQ0tHLE1BQU0sUUFDSFAsSUFBSyxRQUNMUSxZQUFhLDhCQUNibEIsV0FBWSxtQkFHZmlCLE1BQU0sWUFoQmZ0RSxRQUNLQyxPQUFPLGVBQ1BpRSxPQUFPQSxHQUVaQSxFQUFPWixTQUFXLGlCQUFrQix5QkNKeEMsV0FFUSxpQkFBbUJrQixZQUNuQkEsVUFBVUMsY0FBY0MsU0FBUyxVQUFZQyxNQUFPLE1BQU9uRCxLQUFLLFNBQVNvRCxHQUVyRTdCLFFBQVF6QixJQUFJLG9DQUFzQ3NELEVBQUlELFNBRjFESCxTQUdTLFNBQVNLLEdBRWQ5QixRQUFRekIsSUFBSSw0QkFBOEJ1RCIsImZpbGUiOiJhbGwubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCd0cmFuc2l0LWFwcCcsIFsndWkucm91dGVyJ10pO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3RyYW5zaXQtYXBwJykuY29uc3RhbnQoJ1dNQVRBX0FQSV9LRVknLCAnYjhkNzJkNDQ0M2Q4NGMwYTlhY2M4YzZlNDQ4MWEzYjknKTtcbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbi8qKlxuICogQ3JlYXRlZCBieSBhbmRyZXcgb24gMy8yMy8xNi5cbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgndHJhbnNpdC1hcHAnKS5jb250cm9sbGVyKCdIb21lQ29udHJvbGxlcicsIEhvbWVDb250cm9sbGVyKTtcblxuICAgIEhvbWVDb250cm9sbGVyLiRpbmplY3QgPSBbJyRsb2cnLCAnbG9jYWxSZXNvdXJjZVNlcnZpY2UnLCAnJHNjb3BlJ107XG5cbiAgICBmdW5jdGlvbiBIb21lQ29udHJvbGxlcigkbG9nLCBsb2NhbFJlc291cmNlU2VydmljZSwgJHNjb3BlKSB7XG5cbiAgICAgICAgJHNjb3BlLnZhbGlkUm91dGUgPSB0cnVlO1xuXG4gICAgICAgICRzY29wZS5nZXRTY2hlZHVsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIHZhciBjdXJyZW50VGltZSA9IGRhdGUuZ2V0SG91cnMoKSArICc6JyArIGRhdGUuZ2V0TWludXRlcygpICsgJzonICsgZGF0ZS5nZXRTZWNvbmRzKCk7XG4gICAgICAgICAgICAkc2NvcGUuc2NoZWR1bGVzID0gZmluZFZhbGlkVHJpcCgkc2NvcGUub3JpZ2luYXRpb25JZCwgJHNjb3BlLmRlc3RpbmF0aW9uSWQpLmZpbHRlcihmdW5jdGlvbiAodHJpcCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cmlwLm9yaWdUaW1lID49IGN1cnJlbnRUaW1lICYmIHRyaXAub3JpZ1RpbWUgPCAnMjQ6MDA6MDAnO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkbG9nLmxvZygkc2NvcGUuc2NoZWR1bGVzKTtcbiAgICAgICAgfTtcblxuICAgICAgICBsb2NhbFJlc291cmNlU2VydmljZS5zdG9wcygpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICByZXR1cm4gUGFwYS5wYXJzZShyZXNwb25zZS5kYXRhLCB7XG4gICAgICAgICAgICAgICAgZGVsaW1pdGVyOiAnLCcsXG4gICAgICAgICAgICAgICAgaGVhZGVyOiB0cnVlXG4gICAgICAgICAgICB9KS5kYXRhO1xuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAkc2NvcGUuc3RvcHMgPSBkYXRhO1xuICAgICAgICB9KTtcblxuICAgICAgICBsb2NhbFJlc291cmNlU2VydmljZS5zdG9wVGltZXMoKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgcmV0dXJuIFBhcGEucGFyc2UocmVzcG9uc2UuZGF0YSwge1xuICAgICAgICAgICAgICAgIGRlbGltaXRlcjogJywnLFxuICAgICAgICAgICAgICAgIGhlYWRlcjogdHJ1ZVxuICAgICAgICAgICAgfSkuZGF0YTtcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgJHNjb3BlLnN0b3BUaW1lcyA9IGRhdGE7XG4gICAgICAgICAgICAkbG9nLmxvZygkc2NvcGUuc3RvcFRpbWVzKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdmFyIGZpbmRWYWxpZFRyaXAgPSBmdW5jdGlvbiBmaW5kVmFsaWRUcmlwKG9yaWdJZCwgZGlzdElkKSB7XG4gICAgICAgICAgICB2YXIgdmFsaWRUcmlwcyA9IFtdO1xuICAgICAgICAgICAgdmFyIHRyaXBJZDtcbiAgICAgICAgICAgIHZhciBvcmlnU2VxO1xuICAgICAgICAgICAgdmFyIG9yaWdUaW1lO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gJHNjb3BlLnN0b3BUaW1lcy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChvcmlnSWQgPT09ICRzY29wZS5zdG9wVGltZXNbaV0uc3RvcF9pZCkge1xuICAgICAgICAgICAgICAgICAgICB0cmlwSWQgPSAkc2NvcGUuc3RvcFRpbWVzW2ldLnRyaXBfaWQ7XG4gICAgICAgICAgICAgICAgICAgIG9yaWdTZXEgPSAkc2NvcGUuc3RvcFRpbWVzW2ldLnN0b3Bfc2VxdWVuY2U7XG4gICAgICAgICAgICAgICAgICAgIG9yaWdUaW1lID0gJHNjb3BlLnN0b3BUaW1lc1tpXS5hcnJpdmFsX3RpbWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkaXN0SWQgPT09ICRzY29wZS5zdG9wVGltZXNbaV0uc3RvcF9pZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHJpcElkID09PSAkc2NvcGUuc3RvcFRpbWVzW2ldLnRyaXBfaWQgJiYgb3JpZ1NlcSA8ICRzY29wZS5zdG9wVGltZXNbaV0uc3RvcF9zZXF1ZW5jZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWRUcmlwcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmlwSWQ6IHRyaXBJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnVGltZTogb3JpZ1RpbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzdFRpbWU6ICRzY29wZS5zdG9wVGltZXNbaV0uYXJyaXZhbF90aW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBnZXRUaW1lRGlmZihvcmlnVGltZSwgJHNjb3BlLnN0b3BUaW1lc1tpXS5hcnJpdmFsX3RpbWUpXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZhbGlkVHJpcHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnZhbGlkUm91dGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVGhlIGRlc3RpbmF0aW9uIGlzIG5vdCByZWFjaGFibGUgZnJvbSB0aGUgb3JpZ2luYXRpb24uJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRzY29wZS52YWxpZFJvdXRlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2YWxpZFRyaXBzO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vVG8gYmUgY29tcGxldGVkXG4gICAgICAgIHZhciBnZXRUaW1lRGlmZiA9IGZ1bmN0aW9uIGdldFRpbWVEaWZmKHN0YXJ0VGltZSwgZW5kVGltZSkge1xuICAgICAgICAgICAgdmFyIHN0YXJ0VGltZXN0YW1wID0gc3RhcnRUaW1lLnNwbGl0KCc6Jyk7XG4gICAgICAgICAgICB2YXIgZW5kVGltZXN0YW1wID0gZW5kVGltZS5zcGxpdCgnOicpO1xuXG4gICAgICAgICAgICByZXR1cm4gK2VuZFRpbWVzdGFtcFswXSAqIDYwICsgK2VuZFRpbWVzdGFtcFsxXSAtICgrc3RhcnRUaW1lc3RhbXBbMF0gKiA2MCArICtzdGFydFRpbWVzdGFtcFsxXSk7XG4gICAgICAgIH07XG4gICAgfVxufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBDcmVhdGVkIGJ5IGFuZHJldyBvbiAzLzE3LzE2LlxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCd0cmFuc2l0LWFwcCcpLmZhY3RvcnkoJ2xvY2FsUmVzb3VyY2VTZXJ2aWNlJywgbG9jYWxSZXNvdXJjZVNlcnZpY2UpO1xuXG4gICAgbG9jYWxSZXNvdXJjZVNlcnZpY2UuJGluamVjdCA9IFsnJGh0dHAnXTtcblxuICAgIGZ1bmN0aW9uIGxvY2FsUmVzb3VyY2VTZXJ2aWNlKCRodHRwKSB7XG4gICAgICAgIHZhciByZXNvdXJjZTtcbiAgICAgICAgcmVzb3VyY2UgPSB7XG4gICAgICAgICAgICBhZ2VuY3k6IGFnZW5jeSxcbiAgICAgICAgICAgIHN0b3BzOiBzdG9wcyxcbiAgICAgICAgICAgIHN0b3BUaW1lczogc3RvcFRpbWVzXG4gICAgICAgIH07XG5cbiAgICAgICAgZnVuY3Rpb24gYWdlbmN5KCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnZGF0YS9hZ2VuY3kuanNvbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc3RvcHMoKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCdkYXRhL3JhaWxfc3RvcHMudHh0Jyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzdG9wVGltZXMoKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCdkYXRhL3JhaWxfc3RvcF90aW1lLnR4dCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc291cmNlO1xuICAgIH1cbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbi8qKlxuICogQ3JlYXRlZCBieSBhbmRyZXcgb24gNC8xNC8xNi5cbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgndHJhbnNpdC1hcHAnKS5mYWN0b3J5KCd0cmFpblJlc291cmNlU2VydmljZScsIHRyYWluUmVzb3VyY2VTZXJ2aWNlKTtcblxuICAgIHRyYWluUmVzb3VyY2VTZXJ2aWNlLiRpbmplY3QgPSBbJ1dNQVRBX0FQSV9LRVknLCAnJGh0dHAnXTtcblxuICAgIGZ1bmN0aW9uIHRyYWluUmVzb3VyY2VTZXJ2aWNlKFdNQVRBX0FQSV9LRVksICRodHRwKSB7XG4gICAgICAgIHZhciByZXNvdXJjZTtcblxuICAgICAgICByZXNvdXJjZSA9IHtcbiAgICAgICAgICAgIHN0b3BzOiBzdG9wc1xuICAgICAgICB9O1xuXG4gICAgICAgIGZ1bmN0aW9uIHN0b3BzKCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgICAgIHVybDogJ2h0dHBzOi8vYXBpLndtYXRhLmNvbS9SYWlsLnN2Yy9qc29uL2pTdGF0aW9ucz9MaW5lQ29kZT1SRCcsXG4gICAgICAgICAgICAgICAgaGVhZGVyczogeyAnYXBpX2tleSc6ICdiOGQ3MmQ0NDQzZDg0YzBhOWFjYzhjNmU0NDgxYTNiOScgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVzb3VyY2U7XG4gICAgfVxufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgndHJhbnNpdC1hcHAnKS5jb25maWcoY29uZmlnKTtcblxuICAgIGNvbmZpZy4kaW5qZWN0ID0gWyckc3RhdGVQcm92aWRlcicsICckdXJsUm91dGVyUHJvdmlkZXInXTtcblxuICAgIGZ1bmN0aW9uIGNvbmZpZygkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy9ob21lJyk7XG5cbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2hvbWUnLCB7XG4gICAgICAgICAgICB1cmw6ICcvaG9tZScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9wYXJ0aWFscy9ob21lL2hvbWUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnSG9tZUNvbnRyb2xsZXInXG4gICAgICAgIH0pLnN0YXRlKCdhYm91dCcsIHt9KTtcbiAgICB9XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIENyZWF0ZWQgYnkgYW5kcmV3IG9uIDMvMTUvMTYuXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgaWYgKCdzZXJ2aWNlV29ya2VyJyBpbiBuYXZpZ2F0b3IpIHtcbiAgICAgICAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVnaXN0ZXIoJy9zdy5qcycsIHsgc2NvcGU6ICcvJyB9KS50aGVuKGZ1bmN0aW9uIChyZWcpIHtcbiAgICAgICAgICAgIC8vIHJlZ2lzdHJhdGlvbiB3b3JrZWRcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSZWdpc3RyYXRpb24gc3VjY2VlZGVkLiBTY29wZSBpcyAnICsgcmVnLnNjb3BlKTtcbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAvLyByZWdpc3RyYXRpb24gZmFpbGVkXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVnaXN0cmF0aW9uIGZhaWxlZCB3aXRoICcgKyBlcnJvcik7XG4gICAgICAgIH0pO1xuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgndHJhbnNpdC1hcHAnLCBbJ3VpLnJvdXRlciddKTtcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgndHJhbnNpdC1hcHAnKVxuICAgICAgICAuY29uc3RhbnQoJ1dNQVRBX0FQSV9LRVknLCdiOGQ3MmQ0NDQzZDg0YzBhOWFjYzhjNmU0NDgxYTNiOScpO1xufSkoKTtcbiIsIi8qKlxuICogQ3JlYXRlZCBieSBhbmRyZXcgb24gMy8yMy8xNi5cbiAqL1xuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgndHJhbnNpdC1hcHAnKVxuICAgICAgICAuY29udHJvbGxlcignSG9tZUNvbnRyb2xsZXInLEhvbWVDb250cm9sbGVyKTtcblxuICAgIEhvbWVDb250cm9sbGVyLiRpbmplY3QgPSBbJyRsb2cnLCdsb2NhbFJlc291cmNlU2VydmljZScsJyRzY29wZSddO1xuXG4gICAgZnVuY3Rpb24gSG9tZUNvbnRyb2xsZXIoJGxvZywgbG9jYWxSZXNvdXJjZVNlcnZpY2UsICRzY29wZSkge1xuXG4gICAgICAgICRzY29wZS52YWxpZFJvdXRlID0gdHJ1ZTtcblxuICAgICAgICAkc2NvcGUuZ2V0U2NoZWR1bGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIHZhciBjdXJyZW50VGltZSA9IGRhdGUuZ2V0SG91cnMoKSsnOicrZGF0ZS5nZXRNaW51dGVzKCkrJzonK2RhdGUuZ2V0U2Vjb25kcygpO1xuICAgICAgICAgICAgJHNjb3BlLnNjaGVkdWxlcyA9IGZpbmRWYWxpZFRyaXAoJHNjb3BlLm9yaWdpbmF0aW9uSWQsICRzY29wZS5kZXN0aW5hdGlvbklkKS5maWx0ZXIoZnVuY3Rpb24odHJpcCl7XG4gICAgICAgICAgICAgICAgcmV0dXJuICh0cmlwLm9yaWdUaW1lID49IGN1cnJlbnRUaW1lICYmIHRyaXAub3JpZ1RpbWUgPCAnMjQ6MDA6MDAnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJGxvZy5sb2coJHNjb3BlLnNjaGVkdWxlcyk7XG5cbiAgICAgICAgfTtcblxuXG5cbiAgICAgICAgbG9jYWxSZXNvdXJjZVNlcnZpY2Uuc3RvcHMoKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICAgIHJldHVybiBQYXBhLnBhcnNlKHJlc3BvbnNlLmRhdGEse1xuICAgICAgICAgICAgICAgIGRlbGltaXRlcjogJywnLFxuICAgICAgICAgICAgICAgIGhlYWRlcjogdHJ1ZVxuICAgICAgICAgICAgfSkuZGF0YTtcblxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgJHNjb3BlLnN0b3BzID0gZGF0YTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbG9jYWxSZXNvdXJjZVNlcnZpY2Uuc3RvcFRpbWVzKCkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgICByZXR1cm4gUGFwYS5wYXJzZShyZXNwb25zZS5kYXRhLHtcbiAgICAgICAgICAgICAgICBkZWxpbWl0ZXI6ICcsJyxcbiAgICAgICAgICAgICAgICBoZWFkZXI6IHRydWVcbiAgICAgICAgICAgIH0pLmRhdGE7XG5cbiAgICAgICAgfSkudGhlbihmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICRzY29wZS5zdG9wVGltZXMgPSBkYXRhO1xuICAgICAgICAgICAgJGxvZy5sb2coJHNjb3BlLnN0b3BUaW1lcyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBmaW5kVmFsaWRUcmlwID0gZnVuY3Rpb24gKG9yaWdJZCwgZGlzdElkKSB7XG4gICAgICAgICAgICB2YXIgdmFsaWRUcmlwcyA9IFtdO1xuICAgICAgICAgICAgdmFyIHRyaXBJZDtcbiAgICAgICAgICAgIHZhciBvcmlnU2VxO1xuICAgICAgICAgICAgdmFyIG9yaWdUaW1lO1xuXG4gICAgICAgICAgICBmb3IodmFyIGkgPSAwLCBsZW5ndGggPSAkc2NvcGUuc3RvcFRpbWVzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgICAgICBpZihvcmlnSWQgPT09ICRzY29wZS5zdG9wVGltZXNbaV0uc3RvcF9pZCkge1xuICAgICAgICAgICAgICAgICAgICB0cmlwSWQgPSAkc2NvcGUuc3RvcFRpbWVzW2ldLnRyaXBfaWQ7XG4gICAgICAgICAgICAgICAgICAgIG9yaWdTZXEgPSAkc2NvcGUuc3RvcFRpbWVzW2ldLnN0b3Bfc2VxdWVuY2U7XG4gICAgICAgICAgICAgICAgICAgIG9yaWdUaW1lID0gJHNjb3BlLnN0b3BUaW1lc1tpXS5hcnJpdmFsX3RpbWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkaXN0SWQgPT09ICRzY29wZS5zdG9wVGltZXNbaV0uc3RvcF9pZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHJpcElkID09PSAkc2NvcGUuc3RvcFRpbWVzW2ldLnRyaXBfaWQgJiYgb3JpZ1NlcSA8ICRzY29wZS5zdG9wVGltZXNbaV0uc3RvcF9zZXF1ZW5jZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWRUcmlwcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmlwSWQgOiB0cmlwSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ1RpbWU6IG9yaWdUaW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3RUaW1lOiAkc2NvcGUuc3RvcFRpbWVzW2ldLmFycml2YWxfdGltZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogZ2V0VGltZURpZmYob3JpZ1RpbWUsJHNjb3BlLnN0b3BUaW1lc1tpXS5hcnJpdmFsX3RpbWUpXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKHZhbGlkVHJpcHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnZhbGlkUm91dGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVGhlIGRlc3RpbmF0aW9uIGlzIG5vdCByZWFjaGFibGUgZnJvbSB0aGUgb3JpZ2luYXRpb24uJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRzY29wZS52YWxpZFJvdXRlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2YWxpZFRyaXBzO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vVG8gYmUgY29tcGxldGVkXG4gICAgICAgIHZhciBnZXRUaW1lRGlmZiA9IGZ1bmN0aW9uIChzdGFydFRpbWUsIGVuZFRpbWUpIHtcbiAgICAgICAgICAgIHZhciBzdGFydFRpbWVzdGFtcCA9IHN0YXJ0VGltZS5zcGxpdCgnOicpO1xuICAgICAgICAgICAgdmFyIGVuZFRpbWVzdGFtcCA9IGVuZFRpbWUuc3BsaXQoJzonKTtcblxuICAgICAgICAgICAgcmV0dXJuICgoK2VuZFRpbWVzdGFtcFswXSkqNjAgKyAoK2VuZFRpbWVzdGFtcFsxXSkpIC0gKCgrc3RhcnRUaW1lc3RhbXBbMF0pKjYwICsgKCtzdGFydFRpbWVzdGFtcFsxXSkpO1xuICAgICAgICB9O1xuXG5cblxuICAgIH1cblxufSkoKTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgYW5kcmV3IG9uIDMvMTcvMTYuXG4gKi9cbihmdW5jdGlvbigpe1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgndHJhbnNpdC1hcHAnKVxuICAgICAgICAuZmFjdG9yeSgnbG9jYWxSZXNvdXJjZVNlcnZpY2UnLGxvY2FsUmVzb3VyY2VTZXJ2aWNlKTtcblxuICAgIGxvY2FsUmVzb3VyY2VTZXJ2aWNlLiRpbmplY3QgPSBbJyRodHRwJ107XG5cbiAgICBmdW5jdGlvbiBsb2NhbFJlc291cmNlU2VydmljZSgkaHR0cCkge1xuICAgICAgICB2YXIgcmVzb3VyY2U7XG4gICAgICAgIHJlc291cmNlID0ge1xuICAgICAgICAgICAgYWdlbmN5OiBhZ2VuY3ksXG4gICAgICAgICAgICBzdG9wczogc3RvcHMsXG4gICAgICAgICAgICBzdG9wVGltZXM6IHN0b3BUaW1lc1xuICAgICAgICB9O1xuXG4gICAgICAgIGZ1bmN0aW9uIGFnZW5jeSgpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJ2RhdGEvYWdlbmN5Lmpzb24nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHN0b3BzKCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnZGF0YS9yYWlsX3N0b3BzLnR4dCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc3RvcFRpbWVzKCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnZGF0YS9yYWlsX3N0b3BfdGltZS50eHQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXNvdXJjZTtcbiAgICB9XG59KSgpOyIsIi8qKlxuICogQ3JlYXRlZCBieSBhbmRyZXcgb24gNC8xNC8xNi5cbiAqL1xuKGZ1bmN0aW9uKCl7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCd0cmFuc2l0LWFwcCcpXG4gICAgICAgIC5mYWN0b3J5KCd0cmFpblJlc291cmNlU2VydmljZScsdHJhaW5SZXNvdXJjZVNlcnZpY2UpO1xuXG4gICAgdHJhaW5SZXNvdXJjZVNlcnZpY2UuJGluamVjdCA9IFsnV01BVEFfQVBJX0tFWScsJyRodHRwJ107XG5cbiAgICBmdW5jdGlvbiB0cmFpblJlc291cmNlU2VydmljZShXTUFUQV9BUElfS0VZLCRodHRwKSB7XG4gICAgICAgIHZhciByZXNvdXJjZTtcblxuICAgICAgICByZXNvdXJjZSA9IHtcbiAgICAgICAgICAgIHN0b3BzIDogc3RvcHNcbiAgICAgICAgfTtcblxuICAgICAgICBmdW5jdGlvbiBzdG9wcygpIHtcbiAgICAgICAgICAgIHJldHVybiAgJGh0dHAoe1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9hcGkud21hdGEuY29tL1JhaWwuc3ZjL2pzb24valN0YXRpb25zP0xpbmVDb2RlPVJEJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7J2FwaV9rZXknOiAnYjhkNzJkNDQ0M2Q4NGMwYTlhY2M4YzZlNDQ4MWEzYjknfVxuICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc291cmNlO1xuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3RyYW5zaXQtYXBwJylcbiAgICAgICAgLmNvbmZpZyhjb25maWcpO1xuXG4gICAgY29uZmlnLiRpbmplY3QgPSBbJyRzdGF0ZVByb3ZpZGVyJywgJyR1cmxSb3V0ZXJQcm92aWRlciddO1xuXG4gICAgZnVuY3Rpb24gY29uZmlnKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcbiAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnL2hvbWUnKTtcblxuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdob21lJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9ob21lJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9wYXJ0aWFscy9ob21lL2hvbWUuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0hvbWVDb250cm9sbGVyJ1xuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgLnN0YXRlKCdhYm91dCcsIHt9KTtcblxuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGFuZHJldyBvbiAzLzE1LzE2LlxuICovXG4oZnVuY3Rpb24oKXtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgaWYgKCdzZXJ2aWNlV29ya2VyJyBpbiBuYXZpZ2F0b3IpIHtcbiAgICAgICAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVnaXN0ZXIoJy9zdy5qcycsIHsgc2NvcGU6ICcvJyB9KS50aGVuKGZ1bmN0aW9uKHJlZykge1xuICAgICAgICAgICAgLy8gcmVnaXN0cmF0aW9uIHdvcmtlZFxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1JlZ2lzdHJhdGlvbiBzdWNjZWVkZWQuIFNjb3BlIGlzICcgKyByZWcuc2NvcGUpO1xuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgLy8gcmVnaXN0cmF0aW9uIGZhaWxlZFxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1JlZ2lzdHJhdGlvbiBmYWlsZWQgd2l0aCAnICsgZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICB9XG59KSgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
